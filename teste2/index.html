<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Pet Dudis - In√≠cio</title>

<link rel="stylesheet" href="style.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>

<style>
/* ======= Cabe√ßalho e A√ß√µes do Usu√°rio ======= */
.acoes-usuario { display:flex; align-items:center; gap:18px; font-size:.95rem; position:relative; }
.acoes-usuario a, .acoes-usuario span { color:#333; text-decoration:none; cursor:pointer; }
.acoes-usuario a:hover, .acoes-usuario span:hover { color:#5e2ca5; }
.usuario-logado { display:none; align-items:center; gap:8px; position:relative; }
.usuario-chip { display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; border:1px solid #e5e5e5; background:#fff; transition: box-shadow .2s ease, transform .05s ease; user-select:none; }
.usuario-chip:hover { box-shadow:0 6px 18px rgba(0,0,0,.08); }
.usuario-iniciais { width:28px; height:28px; border-radius:50%; display:flex; justify-content:center; align-items:center; background:#5e2ca5; color:#fff; font-weight:700; font-size:.9rem; }
.usuario-nome { font-weight:700; }
.usuario-seta { margin-left:2px; transition:.2s; font-size:.9rem; color:#777; }
.usuario-chip[aria-expanded="true"] .usuario-seta { transform:rotate(180deg); }

/* ======= Painel lateral ======= */
.painel-overlay { position:fixed; inset:0; background:rgba(0,0,0,.45); opacity:0; visibility:hidden; transition:.2s; z-index:1000; }
.painel-overlay.ativo { opacity:1; visibility:visible; }
.painel-cliente { position:fixed; top:0; right:0; height:100vh; width:min(92vw,360px); background:#fff; box-shadow:-10px 0 30px rgba(0,0,0,.15); transform:translateX(100%); transition:.25s; z-index:1001; display:flex; flex-direction:column; }
.painel-cliente.ativo { transform:translateX(0); }
.painel-topo { display:flex; align-items:center; gap:12px; padding:16px 18px; border-bottom:1px solid #f0f0f0; }
.painel-topo .foto { width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:#5e2ca5; color:#fff; font-weight:700; }
.painel-topo .info { flex:1; }
.painel-topo .info .nome { font-weight:800; color:#333; line-height:1.15; }
.painel-topo .info .email { font-size:.85rem; color:#777; }
.painel-fechar { background:transparent; border:none; font-size:1.1rem; cursor:pointer; color:#666; }
.painel-lista { padding:10px 10px 18px; overflow-y:auto; flex:1; }
.secao { margin-top:12px; border:1px solid #efefef; border-radius:12px; overflow:hidden; }
.secao-titulo { padding:10px 12px; font-size:.85rem; font-weight:800; color:#5e2ca5; background:#faf8ff; border-bottom:1px solid #efefef; }
.link-item { display:flex; align-items:center; gap:12px; padding:12px 14px; color:#333; text-decoration:none; border-bottom:1px solid #f5f5f5; }
.link-item:last-child { border-bottom:0; }
.link-item:hover { background:#f9f9ff; }
.link-item i { width:22px; text-align:center; color:#5e2ca5; }
.chip-role { margin-left:auto; font-size:.75rem; padding:3px 8px; border-radius:999px; background:#eef3ff; border:1px solid #dbe4ff; color:#3556d1; font-weight:700; }
.painel-rodape { padding:10px 12px 16px; display:flex; gap:8px; flex-wrap:wrap; }
.btn-sair, .btn-ir-area { display:flex; align-items:center; gap:8px; padding:10px 12px; border-radius:10px; font-weight:700; cursor:pointer; border:1px solid #eee; }
.btn-ir-area { background:#5e2ca5; color:#fff; border-color:#5e2ca5; }
.btn-sair:hover { background:#f9f9f9; }
.btn-ir-area:hover { filter:brightness(0.97); }

/* ======= Modal Login ======= */
.modal-login { display:none; position:fixed; z-index:1100; left:0; top:0; width:100%; height:100%; overflow:auto; background:rgba(0,0,0,0.6); }
.modal-login-content { background:#fff; margin:8% auto; padding:20px; border-radius:12px; width:90%; max-width:420px; position:relative; box-shadow:0 18px 50px rgba(0,0,0,.25); }
.modal-login-content h2 { text-align:center; margin-bottom:20px; }
.modal-login-content input { width:100%; padding:12px; margin:6px 0; border:1px solid #ddd; border-radius:8px; }
.modal-login-content button { width:100%; padding:12px; margin:10px 0; background:#5e2ca5; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:800; }
.modal-login-content .fechar { position:absolute; top:10px; right:15px; font-size:24px; cursor:pointer; }
.tab-login { display:flex; justify-content:space-around; margin-bottom:15px; cursor:pointer; }
.tab-login div { padding:10px 20px; border-bottom:2px solid transparent; }
.tab-login .ativo { border-bottom:2px solid #5e2ca5; font-weight:800; color:#5e2ca5; }
</style>
</head>
<body>

<header class="cabecalho">
  <div class="cabecalho-conteudo">
    <div class="logo-container"><img src="img/logo.png" alt="Pet Dudis" class="logo"/></div>
    <div class="cep-busca">
      <div class="cep-input-wrapper"><span>üìç</span><input type="text" placeholder="Informar CEP" class="cep-input"></div>
      <div class="busca-input-wrapper"><span>üîç</span><input type="text" placeholder="O que seu pet precisa?" class="busca-input"><button class="btn-busca">üîç</button></div>
    </div>
    <div class="acoes-usuario">
      <a href="#"><i class="fas fa-sync-alt"></i> Recorr√™ncia</a>
      <a href="#"><i class="fas fa-box"></i> Pedidos</a>
      <span id="botao-login"><i class="fas fa-user"></i> Entrar | Cadastrar</span>
      <div class="usuario-logado" id="usuario-logado">
        <button id="usuario-chip" class="usuario-chip" aria-expanded="false" aria-controls="painel-cliente">
          <span class="usuario-iniciais" id="usuario-iniciais">U</span>
          <span class="usuario-nome" id="nome-usuario">Usu√°rio</span>
          <i class="fa-solid fa-chevron-down usuario-seta"></i>
        </button>
      </div>
    </div>
  </div>
</header>

<nav class="faixa-categorias">
  <div class="categoria"><i class="fas fa-dog"></i><span>C√£es</span></div>
  <div class="categoria"><i class="fas fa-cat"></i><span>Gatos</span></div>
  <div class="categoria"><i class="fas fa-hippo"></i><span>Roedores</span></div>
  <div class="categoria"><i class="fas fa-dove"></i><span>P√°ssaros</span></div>
  <div class="categoria"><i class="fas fa-fish"></i><span>Peixes</span></div>
</nav>

<div class="swiper banner-swiper">
  <div class="swiper-wrapper">
    <div class="swiper-slide"><img src="img/banner1.jpg" alt="Banner 1"/></div>
    <div class="swiper-slide"><img src="img/banner2.jpg" alt="Banner 2"/></div>
    <div class="swiper-slide"><img src="img/banner3.jpg" alt="Banner 3"/></div>
  </div>
  <div class="swiper-pagination"></div>
  <div class="swiper-button-prev"></div>
  <div class="swiper-button-next"></div>
</div>

<div class="painel-overlay" id="painel-overlay"></div>
<aside class="painel-cliente" id="painel-cliente">
  <div class="painel-topo">
    <div class="foto" id="painel-iniciais">U</div>
    <div class="info">
      <div class="nome" id="painel-nome">Nome</div>
      <div class="email" id="painel-email">email@teste.com</div>
    </div>
    <button class="painel-fechar" id="painel-fechar">&times;</button>
  </div>
  <div class="painel-lista">
    <div class="secao" id="secao-cliente">
      <div class="secao-titulo">Cliente</div>
      <a class="link-item" href="#"><i class="fas fa-heart"></i> Meus Favoritos</a>
    </div>
    <div class="secao" id="secao-parceiro" hidden>
      <div class="secao-titulo">Parceiro</div>
      <a class="link-item" href="#"><i class="fas fa-store"></i> Meus Produtos</a>
    </div>
    <div class="secao" id="secao-funcionario" hidden>
      <div class="secao-titulo">Funcion√°rio</div>
      <a class="link-item" href="#"><i class="fas fa-clipboard-list"></i> Atendimentos</a>
    </div>
    <div class="secao" id="secao-admin" hidden>
      <div class="secao-titulo">Admin</div>
      <a class="link-item" href="#"><i class="fas fa-users-cog"></i> Gerenciar Usu√°rios</a>
    </div>
  </div>
  <div class="painel-rodape">
    <button class="btn-ir-area" id="btn-ir-area">Ir para √Årea</button>
    <button class="btn-sair" id="btn-sair">Sair</button>
  </div>
</aside>

<div class="modal-login" id="modal-login">
  <div class="modal-login-content">
    <span class="fechar" id="fechar-modal">&times;</span>
    <div class="tab-login">
      <div id="tab-entrar" class="ativo">Entrar</div>
      <div id="tab-cadastrar">Cadastrar</div>
    </div>
    <form id="form-entrar">
      <input type="email" placeholder="Email" id="login-email" required/>
      <input type="password" placeholder="Senha" id="login-senha" required/>
      <button type="submit">Entrar</button>
    </form>
    <form id="form-cadastrar" style="display:none;">
      <input type="text" placeholder="Nome completo" id="cad-nome" required/>
      <input type="email" placeholder="Email" id="cad-email" required/>
      <input type="password" placeholder="Senha" id="cad-senha" required/>
      <button type="submit">Cadastrar</button>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
// ======= Firebase =======
const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_DOMINIO.firebaseapp.com",
  projectId: "SEU_PROJECT_ID",
  storageBucket: "SEU_BUCKET",
  messagingSenderId: "SEU_SENDER",
  appId: "SEU_APPID"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// ======= Swiper =======
new Swiper('.banner-swiper', { loop:true, slidesPerView:1, spaceBetween:20,
  pagination:{ el:'.swiper-pagination', clickable:true },
  navigation:{ nextEl:'.swiper-button-next', prevEl:'.swiper-button-prev' },
  autoplay:{ delay:4000, disableOnInteraction:false }
});

// ======= Elementos =======
const botaoLogin = document.getElementById('botao-login');
const modalLogin = document.getElementById('modal-login');
const fecharModalBtn = document.getElementById('fechar-modal');
const tabEntrar = document.getElementById('tab-entrar');
const tabCadastrar = document.getElementById('tab-cadastrar');
const formEntrar = document.getElementById('form-entrar');
const formCadastrar = document.getElementById('form-cadastrar');
const usuarioLogadoWrap = document.getElementById('usuario-logado');
const usuarioChip = document.getElementById('usuario-chip');
const nomeUsuarioSpan = document.getElementById('nome-usuario');
const iniciaisSpan = document.getElementById('usuario-iniciais');
const painel = document.getElementById('painel-cliente');
const painelOverlay = document.getElementById('painel-overlay');
const painelFechar = document.getElementById('painel-fechar');
const painelNome = document.getElementById('painel-nome');
const painelEmail = document.getElementById('painel-email');
const painelIniciais = document.getElementById('painel-iniciais');
const btnIrArea = document.getElementById('btn-ir-area');
const btnSair = document.getElementById('btn-sair');
const secaoCliente = document.getElementById('secao-cliente');
const secaoParceiro = document.getElementById('secao-parceiro');
const secaoFuncionario = document.getElementById('secao-funcionario');
const secaoAdmin = document.getElementById('secao-admin');

// ======= Fun√ß√µes =======
const getIniciais = nome=>{ const partes=nome.trim().split(' ').filter(Boolean); if(!partes.length) return 'U'; return (partes[0][0]+partes[partes.length-1][0]).toUpperCase(); };

async function getPerfil(uid){
  const docUser = await db.collection('usuarios').doc(uid).get();
  if(docUser.exists) return { id: uid, ...docUser.data() };
  const user = auth.currentUser;
  return { id: uid, role:'cliente', nome:user?.displayName||'Cliente', email:user?.email||'' };
}

function preencherChipENome(perfil){
  nomeUsuarioSpan.textContent = perfil.nome.split(' ')[0];
  iniciaisSpan.textContent = getIniciais(perfil.nome);
}

function preencherPainel(perfil){
  painelNome.textContent = perfil.nome;
  painelEmail.textContent = perfil.email;
  painelIniciais.textContent = getIniciais(perfil.nome);
  secaoCliente.hidden = secaoParceiro.hidden = secaoFuncionario.hidden = secaoAdmin.hidden = true;
  const role = perfil.role.toLowerCase();
  if(role==='cliente') secaoCliente.hidden=false;
  if(role==='parceiro') secaoParceiro.hidden=false;
  if(role==='funcionario') secaoFuncionario.hidden=false;
  if(role==='admin') secaoAdmin.hidden=false;
  btnIrArea.onclick = ()=>{ 
    if(role==='cliente') window.location.href='areadocliente.html';
    if(role==='parceiro') window.location.href='painel-parceiro.html';
    if(role==='funcionario') window.location.href='painel-funcionario.html';
    if(role==='admin') window.location.href='painel-admin.html';
  };
}

// ======= Painel lateral =======
const abrirPainel = ()=>{ painel.classList.add('ativo'); painelOverlay.classList.add('ativo'); usuarioChip.setAttribute('aria-expanded','true'); };
const fecharPainel = ()=>{ painel.classList.remove('ativo'); painelOverlay.classList.remove('ativo'); usuarioChip.setAttribute('aria-expanded','false'); };
usuarioChip.addEventListener('click', async e=>{ e.stopPropagation(); const user=auth.currentUser; if(!user) return; const perfil=await getPerfil(user.uid); preencherPainel(perfil); abrirPainel(); });
painelFechar.addEventListener('click', fecharPainel);
painelOverlay.addEventListener('click', fecharPainel);

// ======= Modal login =======
botaoLogin.addEventListener('click', ()=>modalLogin.style.display='block');
fecharModalBtn.addEventListener('click', ()=>modalLogin.style.display='none');
tabEntrar.addEventListener('click', ()=>{ formEntrar.style.display='block'; formCadastrar.style.display='none'; tabEntrar.classList.add('ativo'); tabCadastrar.classList.remove('ativo'); });
tabCadastrar.addEventListener('click', ()=>{ formEntrar.style.display='none'; formCadastrar.style.display='block'; tabCadastrar.classList.add('ativo'); tabEntrar.classList.remove('ativo'); });

// ======= Login/Cadastro Firebase =======
formEntrar.addEventListener('submit', async e=>{
  e.preventDefault();
  const email = document.getElementById('login-email').value;
  const senha = document.getElementById('login-senha').value;
  try{ await auth.signInWithEmailAndPassword(email,senha); modalLogin.style.display='none'; }
  catch(err){ alert(err.message); }
});
formCadastrar.addEventListener('submit', async e=>{
  e.preventDefault();
  const nome = document.getElementById('cad-nome').value;
  const email = document.getElementById('cad-email').value;
  const senha = document.getElementById('cad-senha').value;
  try{
    const cred = await auth.createUserWithEmailAndPassword(email,senha);
    await cred.user.updateProfile({ displayName:nome });
    await db.collection('usuarios').doc(cred.user.uid).set({ nome, role:'cliente', email });
    modalLogin.style.display='none';
  }catch(err){ alert(err.message); }
});

// ======= Atualiza UI =======
auth.onAuthStateChanged(async user=>{
  if(user){
    usuarioLogadoWrap.style.display='flex'; botaoLogin.style.display='none';
    const perfil = await getPerfil(user.uid);
    preencherChipENome(perfil);
  }else{
    usuarioLogadoWrap.style.display='none'; botaoLogin.style.display='inline-flex';
  }
});
btnSair.addEventListener('click', ()=>{ auth.signOut(); fecharPainel(); });

// ======= Fecha modal clicando fora =======
window.addEventListener('click', e=>{ if(e.target===modalLogin) modalLogin.style.display='none'; });
</script>
</body>
</html>
