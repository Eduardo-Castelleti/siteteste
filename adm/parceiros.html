<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Parceiros</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana; background:#f4f4f4; padding:20px; }
h1 { text-align:center; margin-bottom:20px; color:#2c3e50; }
button#addPartnerBtn { float:right; background:#2980b9; color:#fff; border:none; padding:10px 20px; border-radius:4px; cursor:pointer; margin-bottom:10px; }
table { width:100%; border-collapse: collapse; background:#fff; box-shadow:0 0 10px rgba(0,0,0,0.1);}
th, td { padding:12px; border-bottom:1px solid #ddd; text-align:left; }
th { background-color:#2980b9; color:#fff; }
tr:hover { background:#f1f1f1; }
.status-active { color:green; font-weight:bold; }
.status-inactive { color:red; font-weight:bold; }
.action-btn { background:none; border:none; color:#2980b9; margin-right:10px; cursor:pointer; }
</style>
</head>
<body>

<h1>Parceiros</h1>
<button id="addPartnerBtn">Adicionar Parceiro <i class="fas fa-plus"></i></button>

<table>
  <thead>
    <tr>
      <th>Nome</th>
      <th>Tipo</th>
      <th>Responsável</th>
      <th>Telefone</th>
      <th>E-mail</th>
      <th>Status</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody id="partnersTable"></tbody>
</table>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyDVr6OOQRt2rB0kByInjqjdyoQCpnMAt7I",
  authDomain: "site-f6495.firebaseapp.com",
  projectId: "site-f6495",
  storageBucket: "site-f6495.firebasestorage.app",
  messagingSenderId: "230161402024",
  appId: "1:230161402024:web:462a911919ebf8a0809a9d",
  measurementId: "G-51G8XF6JH0"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const partnersTable = document.getElementById('partnersTable');
const addPartnerBtn = document.getElementById('addPartnerBtn');

addPartnerBtn.addEventListener('click', () => {
  window.location.href = 'adicionar-parceiro.html';
});

// ===== CARREGAR PARCEIROS =====
db.collection('parceiros').onSnapshot(snapshot => {
  partnersTable.innerHTML = '';
  snapshot.forEach(doc => {
    const p = doc.data();
    const tipos = p.tipo.join(', '); // agora é array
    partnersTable.innerHTML += `
      <tr>
        <td>${p.nome}</td>
        <td>${tipos}</td>
        <td>${p.responsavel}</td>
        <td>${p.telefone}</td>
        <td>${p.email}</td>
        <td class="${p.status === 'Ativo' ? 'status-active' : 'status-inactive'}">${p.status}</td>
        <td>
          <button class="action-btn" onclick="editPartner('${doc.id}')"><i class="fas fa-edit"></i></button>
          <button class="action-btn" onclick="deletePartner('${doc.id}')"><i class="fas fa-trash-alt"></i></button>
        </td>
      </tr>
    `;
  });
});

// ===== EDITAR E DELETAR =====
function editPartner(id){ window.location.href = 'adicionar-parceiro.html?id=' + id; }
function deletePartner(id){ if(confirm('Deseja realmente deletar este parceiro?')) db.collection('parceiros').doc(id).delete(); }
</script>

</body>
</html>
