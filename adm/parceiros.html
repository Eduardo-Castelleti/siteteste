<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin - Parceiros</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
  <style>
    * {margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
    body {display:flex;height:100vh;background:#f4f6f9;}

    /* ===== Sidebar ===== */
    .sidebar {
      width: 220px;
      background: #2c3e50; /* mesma cor usada no menu Clientes */
      color: #fff;
      display: flex;
      flex-direction: column;
      padding-top: 20px;
    }
    .sidebar h2 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 20px;
    }
    .sidebar a {
      padding: 12px 20px;
      color: #ecf0f1;
      text-decoration: none;
      display: block;
      transition: background 0.3s;
    }
    .sidebar a:hover {
      background: #34495e;
    }
    .sidebar a.active {
      background: #1abc9c;
    }

    /* ===== Main content ===== */
    .main {
      flex:1;
      padding:20px;
      overflow-y:auto;
    }
    h1 {margin-bottom:20px;color:#333;}

    button {
      padding:10px 15px;
      background:#1abc9c;
      color:#fff;
      border:none;
      border-radius:5px;
      cursor:pointer;
    }
    button:hover {background:#16a085;}

    table {
      width:100%;
      border-collapse:collapse;
      margin-top:20px;
      background:#fff;
      border-radius:8px;
      overflow:hidden;
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }
    th, td {
      padding:12px;
      text-align:left;
      border-bottom:1px solid #ddd;
    }
    th {background:#1abc9c;color:#fff;}
    tr:hover {background:#f1f1f1;}

    /* Modal */
    .modal {
      display:none;
      position:fixed;
      z-index:1000;
      left:0;top:0;
      width:100%;height:100%;
      background:rgba(0,0,0,0.5);
      justify-content:center;
      align-items:center;
    }
    .modal-content {
      background:#fff;
      padding:20px;
      border-radius:8px;
      width:400px;
      box-shadow:0 2px 8px rgba(0,0,0,0.2);
    }
    .modal-content h2 {margin-bottom:15px;}
    .modal-content input {
      width:100%;
      padding:10px;
      margin-bottom:10px;
      border:1px solid #ccc;
      border-radius:5px;
    }
    .close {
      float:right;
      font-size:20px;
      cursor:pointer;
      color:#aaa;
    }
    .close:hover {color:#000;}
  </style>
</head>
<body>

  <!-- Sidebar -->
  <div class="sidebar">
  <h2>Admin Petshop</h2>
  <ul>
    <li><a href="index.html" class="active"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
    <li><a href="clientes.html"><i class="fas fa-user"></i> Clientes</a></li>
    <li><a href="parceiros.html"><i class="fas fa-handshake"></i> Parceiros</a></li>
    <li><a href="funcionarios.html"><i class="fas fa-users"></i> Funcionários</a></li>
    <li><a href="produtos.html"><i class="fas fa-box"></i> Produtos</a></li>
    <li><a href="agendamentos.html"><i class="fas fa-calendar-alt"></i> Agendamentos</a></li>
    <li><a href="vendas.html"><i class="fas fa-receipt"></i> Vendas</a></li>
  </ul>
</div>

<script>
// Destacar aba ativa automaticamente
document.querySelectorAll(".sidebar ul li a").forEach(link => {
  if(link.href === window.location.href){
    link.classList.add("active");
  }
});
</script>

  <!-- Main content -->
  <div class="main">
    <h1>Gerenciar Parceiros</h1>
    <button id="btnAbrirModal">Adicionar Parceiro</button>

    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>Email</th>
          <th>Telefone</th>
          <th>CNPJ / CPF</th>
        </tr>
      </thead>
      <tbody id="parceirosLista"></tbody>
    </table>
  </div>

  <!-- Modal -->
  <div id="modalParceiro" class="modal">
    <div class="modal-content">
      <span class="close" id="fecharModal">&times;</span>
      <h2>Novo Parceiro</h2>
      <input type="text" id="nomeParceiro" placeholder="Nome" required />
      <input type="email" id="emailParceiro" placeholder="Email" required />
      <input type="password" id="senhaParceiro" placeholder="Senha" required />
      <input type="text" id="telefoneParceiro" placeholder="Telefone" required />
      <input type="text" id="documentoParceiro" placeholder="CNPJ ou CPF" required />
      <button id="salvarParceiro">Salvar</button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
    import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

    const firebaseConfig = {
  apiKey: "AIzaSyDVr6OOQRt2rB0kByInjqjdyoQCpnMAt7I",
  authDomain: "site-f6495.firebaseapp.com",
  projectId: "site-f6495",
  storageBucket: "site-f6495.firebasestorage.app",
  messagingSenderId: "230161402024",
  appId: "1:230161402024:web:462a911919ebf8a0809a9d",
  measurementId: "G-51G8XF6JH0"
};

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const auth = getAuth(app);

    const btnAbrirModal = document.getElementById("btnAbrirModal");
    const modal = document.getElementById("modalParceiro");
    const fecharModal = document.getElementById("fecharModal");
    const salvarParceiro = document.getElementById("salvarParceiro");
    const parceirosLista = document.getElementById("parceirosLista");

    // Abrir modal
    btnAbrirModal.onclick = () => modal.style.display = "flex";
    fecharModal.onclick = () => modal.style.display = "none";
    window.onclick = (e) => { if(e.target == modal) modal.style.display = "none"; }

    // Salvar Parceiro
    salvarParceiro.onclick = async () => {
      const nome = document.getElementById("nomeParceiro").value;
      const email = document.getElementById("emailParceiro").value;
      const senha = document.getElementById("senhaParceiro").value;
      const telefone = document.getElementById("telefoneParceiro").value;
      const documento = document.getElementById("documentoParceiro").value;

      try {
        const userCred = await createUserWithEmailAndPassword(auth, email, senha);
        const userId = userCred.user.uid;

        await push(ref(db, "parceiros"), {
          uid: userId,
          nome, email, telefone, documento
        });

        alert("Parceiro adicionado com sucesso!");
        modal.style.display = "none";
      } catch (error) {
        alert("Erro: " + error.message);
      }
    };

    // Listar Parceiros
    const parceirosRef = ref(db, "parceiros");
    onValue(parceirosRef, (snapshot) => {
      parceirosLista.innerHTML = "";
      snapshot.forEach((childSnapshot) => {
        const p = childSnapshot.val();
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${p.nome}</td>
          <td>${p.email}</td>
          <td>${p.telefone}</td>
          <td>${p.documento}</td>
        `;
        parceirosLista.appendChild(tr);
      });
    });

    // Botão Funcionário -> redireciona para cadastro
    document.getElementById("btnAbrirFuncionario").onclick = () => {
      window.location.href = "funcionarios.html";
    };
  </script>
</body>
</html>
