<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Pet - Cadastrar Produto</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* {margin:0; padding:0; box-sizing:border-box; font-family:'Roboto',sans-serif;}
body {display:flex; min-height:100vh; background:#f4f6f9;}
.sidebar {width:260px; background:#2c3e50; color:#ecf0f1; flex-shrink:0; display:flex; flex-direction:column;}
.sidebar h2 {text-align:center; padding:20px 0; border-bottom:1px solid #34495e;}
.sidebar a {padding:15px 25px; display:flex; align-items:center; color:#ecf0f1; text-decoration:none; border-bottom:1px solid #34495e; transition:0.3s;}
.sidebar a:hover {background:#34495e;}
.sidebar a i {margin-right:15px;}
.main-content {flex:1; padding:20px; overflow-y:auto;}
h1 {margin-bottom:20px; color:#2c3e50;}
form {background:#fff; padding:20px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1);}
form h2 {margin-bottom:15px;}
input, select, textarea, button {width:100%; margin-bottom:15px; padding:10px; border:1px solid #ccc; border-radius:5px; font-size:16px;}
button {background:#2980b9; color:#fff; border:none; cursor:pointer; transition:0.3s;}
button:hover {background:#3498db;}
.tab {display:none;}
.tab.active {display:block;}
.tab-buttons {display:flex; margin-bottom:20px; gap:10px;}
.tab-buttons button {flex:1; background:#bdc3c7; color:#2c3e50; font-weight:500;}
.tab-buttons button.active {background:#2980b9; color:#fff;}
.table-container {overflow-x:auto;}
table {width:100%; border-collapse:collapse; margin-bottom:15px;}
table th, table td {padding:10px; border:1px solid #ccc; text-align:left;}
.add-variation {width:auto; background:#16a085;}
.add-variation:hover {background:#1abc9c;}
</style>
</head>
<body>

<div class="sidebar">
<h2>Admin Pet</h2>
<a href="index.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
<a href="clientes.html"><i class="fas fa-user"></i> Clientes</a>
<a href="parceiros.html"><i class="fas fa-building"></i> Parceiros</a>
<a href="funcionarios.html"><i class="fas fa-users"></i> Funcionários</a>
<a href="produtos.html"><i class="fas fa-box"></i> Produtos</a>
</div>

<div class="main-content">
<h1>Cadastrar Produto</h1>

<form id="produtoForm">
  <div class="tab-buttons">
    <button type="button" class="active" onclick="showTab(0)">Geral</button>
    <button type="button" onclick="showTab(1)">Composição</button>
    <button type="button" onclick="showTab(2)">Variações</button>
    <button type="button" onclick="showTab(3)">Troca & Garantia</button>
  </div>

  <!-- Aba Geral -->
  <div class="tab active">
    <h2>Informações Básicas</h2>
    <input type="text" id="nome" placeholder="Nome do Produto" required>
    <input type="text" id="marca" placeholder="Marca" required>
    <select id="categoria" required>
      <option value="">Selecione a Categoria</option>
      <option value="ração">Ração</option>
      <option value="petisco">Petisco</option>
      <option value="acessório">Acessório</option>
    </select>
    <select id="animal" required>
      <option value="">Selecione o Animal</option>
      <option value="cachorro">Cachorro</option>
      <option value="gato">Gato</option>
      <option value="passaro">Pássaro</option>
      <option value="coelho">Coelho</option>
      <option value="outro">Outro</option>
    </select>
    <input type="url" id="imagem" placeholder="URL da Imagem">
    <textarea id="descricao" placeholder="Descrição do Produto"></textarea>
  </div>

  <!-- Aba Composição -->
  <div class="tab">
    <h2>Composição e Ingredientes</h2>
    <textarea id="composicao" placeholder="Composição nutricional"></textarea>
    <textarea id="ingredientes" placeholder="Ingredientes"></textarea>
  </div>

  <!-- Aba Variações -->
  <div class="tab">
    <h2>Variações (Peso, Preço, Validade)</h2>
    <div class="table-container">
      <table id="variacoesTable">
        <thead>
          <tr>
            <th>Peso</th>
            <th>Valor de Compra</th>
            <th>Valor de Venda</th>
            <th>Validade</th>
            <th>Quantidade</th>
            <th>Ação</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <button type="button" class="add-variation" onclick="addVariacao()">+ Adicionar Variação</button>
  </div>

  <!-- Aba Troca & Garantia -->
  <div class="tab">
    <h2>Troca & Garantia</h2>
    <select id="trocaPermitida">
      <option value="nao">Troca Não Permitida</option>
      <option value="sim">Troca Permitida</option>
    </select>
    <textarea id="instrucaoTroca" placeholder="Instruções de Troca"></textarea>
    <select id="garantiaFabrica">
      <option value="nao">Sem Garantia de Fábrica</option>
      <option value="sim">Com Garantia de Fábrica</option>
    </select>
    <input type="number" id="porcentagemGarantia" placeholder="% de Garantia" min="0" max="100">
    <input type="number" id="porcentagemTroca" placeholder="% restante para Troca" min="0" max="100">
  </div>

  <button type="submit">Salvar Produto</button>
</form>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_PROJETO.firebaseapp.com",
  projectId: "SEU_PROJETO",
  storageBucket: "SEU_PROJETO.appspot.com",
  messagingSenderId: "SEU_SENDER_ID",
  appId: "SEU_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Função abas
const tabs = document.querySelectorAll('.tab');
const tabButtons = document.querySelectorAll('.tab-buttons button');
function showTab(index){
  tabs.forEach(t=>t.classList.remove('active'));
  tabs[index].classList.add('active');
  tabButtons.forEach(b=>b.classList.remove('active'));
  tabButtons[index].classList.add('active');
}

// Adicionar variação
function addVariacao(){
  const tbody = document.querySelector('#variacoesTable tbody');
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td><input type="text" placeholder="Peso"></td>
    <td><input type="number" placeholder="Valor de Compra" step="0.01"></td>
    <td><input type="number" placeholder="Valor de Venda" step="0.01"></td>
    <td><input type="date"></td>
    <td><input type="number" placeholder="Quantidade"></td>
    <td><button type="button" onclick="this.closest('tr').remove()">Remover</button></td>
  `;
  tbody.appendChild(tr);
}

// Salvar produto
document.getElementById('produtoForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  
  const produto = {
    nome: document.getElementById('nome').value,
    marca: document.getElementById('marca').value,
    categoria: document.getElementById('categoria').value,
    animal: document.getElementById('animal').value,
    imagem: document.getElementById('imagem').value,
    descricao: document.getElementById('descricao').value,
    composicao: document.getElementById('composicao').value,
    ingredientes: document.getElementById('ingredientes').value,
    trocaPermitida: document.getElementById('trocaPermitida').value,
    instrucaoTroca: document.getElementById('instrucaoTroca').value,
    garantiaFabrica: document.getElementById('garantiaFabrica').value,
    porcentagemGarantia: Number(document.getElementById('porcentagemGarantia').value || 0),
    porcentagemTroca: Number(document.getElementById('porcentagemTroca').value || 0),
    variacoes: []
  };

  // Coletar variações
  document.querySelectorAll('#variacoesTable tbody tr').forEach(tr=>{
    const tds = tr.querySelectorAll('input');
    produto.variacoes.push({
      peso: tds[0].value,
      valorCompra: Number(tds[1].value || 0),
      valorVenda: Number(tds[2].value || 0),
      validade: tds[3].value,
      quantidade: Number(tds[4].value || 0)
    });
  });

  try{
    await db.collection('produtos').add(produto);
    alert('Produto salvo com sucesso!');
    location.reload();
  }catch(err){
    alert('Erro ao salvar: '+err.message);
  }
});
</script>

</body>
</html>
