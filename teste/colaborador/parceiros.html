<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Pet - Parceiros</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body { font-family:'Roboto',sans-serif; margin:0; display:flex; height:100vh; background:#f4f6f9; }
    
  /* Menu lateral */
  .sidebar {
    width: 250px;
    background-color: #2c3e50;
    color: #fff;
    display: flex;
    flex-direction: column;
    padding-top: 20px;
  }
  .sidebar h2 { text-align:center; margin-bottom:30px; font-size:20px; font-weight:700; }
  .sidebar a { padding:15px 20px; text-decoration:none; color:#ecf0f1; display:block; transition:0.3s; font-weight:500; }
  .sidebar a:hover { background-color: #34495e; }
  .sidebar a.active { background-color:#1abc9c; color:#fff; }
  .content { flex:1; padding:20px; overflow-y:auto; }
  h1 { font-size:24px; margin-bottom:20px; color:#2c3e50; }
  
.cards { display:flex; gap:20px; margin-bottom:20px; }
.card { flex:1; background:white; padding:20px; border-radius:8px; text-align:center; box-shadow:0 2px 4px rgba(0,0,0,0.1); }
.card h3 { margin:0; font-size:18px; color:#555; }
.card p { font-size:22px; margin:5px 0 0; font-weight:bold; }

button { background:#3498db; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; }
button:hover { background:#2980b9; }

table { width:100%; border-collapse:collapse; background:white; border-radius:8px; overflow:hidden; }
th, td { padding:12px; text-align:left; border-bottom:1px solid #ddd; }
th { background:#f8f9fa; }
tr:hover { background:#f1f1f1; cursor:pointer; }

.status-btn { cursor:pointer; padding:5px 10px; border:none; border-radius:5px; color:white; }
.ativo { background: #27ae60; }
.inativo { background: #c0392b; }

/* Modal */
.modal { display:none; position:fixed; top:0; left:0; right:0; bottom:0; background: rgba(0,0,0,0.5); justify-content:center; align-items:center; }
.modal-content { background:white; padding:20px; border-radius:8px; width:700px; max-width:95%; max-height:90%; overflow-y:auto; }
.modal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
.close { cursor:pointer; padding:5px 10px; border:none; background:#c0392b; color:white; border-radius:5px; }

.nav-tabs { display:flex; gap:10px; margin-bottom:15px; }
.nav-tabs button { padding:8px 15px; border:none; border-radius:5px; cursor:pointer; background:#bdc3c7; color:#fff; }
.nav-tabs button.active { background:#3498db; }

.tab { display:none; }
.tab.active { display:block; }

.section-title { font-weight:700; margin:10px 0; }

.form-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(150px,1fr)); gap:10px; margin-bottom:10px; }
.input, .select, .textarea { width:100%; padding:8px; border:1px solid #ccc; border-radius:5px; }

.checkline { display:flex; flex-wrap:wrap; gap:10px; margin-bottom:10px; }

.footer-actions { display:flex; justify-content:flex-end; gap:10px; margin-top:15px; }
.footer-actions button { padding:8px 15px; }
</style>
</head>
<body>

  <!-- Sidebar -->
    <div class="sidebar">
    <h2>Colaborador</h2>
    <a href="index.html" class="active">üì¶ Pedidos</a>
    <a href="clientes.html">üë• Clientes</a>
    <a href="parceiros.html">ü§ù Parceiros</a>
    <a href="produtos.html">üõí Produtos</a>
    <a href="agenda.html">üìÖ Agenda</a>
    <a href="marketing.html">üì¢ Marketing</a>
    <a href="kpi.html">üìä KPI‚Äôs</a>
  </div>

<div class="content">
  <h1>Parceiros</h1>

  <div class="cards">
    <div class="card"><h3>Total de Parceiros</h3><p id="totalParceiros">0</p></div>
    <div class="card"><h3>Ativos</h3><p id="ativosParceiros">0</p></div>
    <div class="card"><h3>Inativos</h3><p id="inativosParceiros">0</p></div>
  </div>

  <button onclick="abrirModal()">+ Cadastrar Parceiro</button>

  <table>
    <thead>
      <tr>
        <th>Nome</th>
        <th>Tipo</th>
        <th>Telefone</th>
        <th>Email</th>
        <th>Status</th>
        <th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody id="parceirosTable"></tbody>
  </table>
</div>

<!-- ====== MODAL CADASTRO/EDI√á√ÉO PARCEIRO ====== -->
<div class="modal" id="modalParceiro">
  <div class="modal-content">
    <div class="modal-header">
      <h2 id="modalTitle">Novo Parceiro</h2>
      <button class="close" onclick="fecharModal()">Fechar</button>
    </div>

    <div class="nav-tabs">
      <button class="tabBtn active" data-tab="tab-empresa">Empresa</button>
      <button class="tabBtn" data-tab="tab-servicos">Servi√ßos</button>
      <button class="tabBtn" data-tab="tab-responsavel">Respons√°vel</button>
      <button class="tabBtn" data-tab="tab-financeiro">Financeiro</button>
    </div>

    <form id="formParceiro">
      <input type="hidden" id="parceiroId">

      <div class="tab active" id="tab-empresa">
        <div class="section-title">Dados da Empresa</div>
        <div class="form-grid">
          <input class="input" id="nomeEmpresa" placeholder="Nome da Empresa *" required>
          <input class="input" id="cnpjCpf" placeholder="CNPJ / CPF *" required>
          <input class="input" id="telefoneEmpresa" placeholder="Telefone">
          <input class="input" id="website" placeholder="Website / Redes sociais">
        </div>
        <div class="section-title">Endere√ßo</div>
        <div class="form-grid">
          <input class="input" id="cep" placeholder="CEP *" maxlength="9">
          <input class="input" id="rua" placeholder="Rua">
          <input class="input" id="numero" placeholder="N√∫mero">
          <input class="input" id="bairro" placeholder="Bairro">
          <input class="input" id="cidade" placeholder="Cidade">
          <input class="input" id="estado" placeholder="Estado">
        </div>
      </div>

      <div class="tab" id="tab-servicos">
        <div class="section-title">Servi√ßos oferecidos</div>
        <div class="checkline">
          <label><input type="checkbox" id="srvBanhoTosa"> Banho & Tosa</label>
          <label><input type="checkbox" id="srvCreche"> Creche</label>
          <label><input type="checkbox" id="srvHospedagem"> Hospedagem</label>
          <label><input type="checkbox" id="srvDogWalker"> Dog Walker</label>
          <label><input type="checkbox" id="srvPetSitter"> Pet Sitter</label>
          <label><input type="checkbox" id="srvAdestramento"> Adestramento</label>
          <label><input type="checkbox" id="srvOutros"> Outros</label>
        </div>
        <input class="input" id="descricaoOutros" placeholder="Descrever outros servi√ßos (opcional)">
      </div>

      <div class="tab" id="tab-responsavel">
        <div class="section-title">Respons√°vel</div>
        <div class="form-grid">
          <input class="input" id="respNome" placeholder="Nome *">
          <input class="input" id="respTelefone" placeholder="Telefone *">
          <input class="input" id="respEmail" type="email" placeholder="E-mail *">
          <input class="input" id="respCargo" placeholder="Cargo / Fun√ß√£o">
        </div>
      </div>

      <div class="tab" id="tab-financeiro">
        <div class="section-title">Financeiro</div>
        <div class="form-grid">
          <input class="input" id="faixaFaturamento" placeholder="Faixa de Faturamento">
          <input class="input" id="formasPagamento" placeholder="Formas de pagamento">
          <input class="input" id="limiteCredito" placeholder="Limite de Cr√©dito">
          <select class="select" id="statusParceiro">
            <option value="Ativo">Ativo</option>
            <option value="Inativo">Inativo</option>
          </select>
        </div>
        <textarea class="textarea" id="observacoes" rows="3" placeholder="Observa√ß√µes"></textarea>
      </div>

      <div class="footer-actions">
        <button type="button" onclick="fecharModal()">Cancelar</button>
        <button type="submit">Salvar Parceiro</button>
      </div>
    </form>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "SEU_AUTH_DOMAIN",
    projectId: "SEU_PROJECT_ID",
    storageBucket: "SEU_STORAGE_BUCKET",
    messagingSenderId: "SEU_MESSAGING_SENDER_ID",
    appId: "SEU_APP_ID"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  let editando = false;

  function abrirModal(parceiro=null) {
    document.getElementById('modalParceiro').style.display='flex';
    document.getElementById('modalTitle').textContent = parceiro ? "Editar Parceiro" : "Novo Parceiro";
    document.getElementById('formParceiro').reset();
    document.getElementById('parceiroId').value = "";
    if(parceiro){
      editando = true;
      document.getElementById('parceiroId').value = parceiro.id;
      document.getElementById('nomeEmpresa').value = parceiro.nomeEmpresa || "";
      document.getElementById('telefoneEmpresa').value = parceiro.telefoneEmpresa || "";
      document.getElementById('respEmail').value = parceiro.respEmail || "";
      document.getElementById('statusParceiro').value = parceiro.status || "Ativo";
    } else {
      editando = false;
    }
  }
  function fecharModal(){ document.getElementById('modalParceiro').style.display='none'; }

  document.getElementById('formParceiro').addEventListener('submit', async function(e){
    e.preventDefault();
    const data = {
      nomeEmpresa: document.getElementById('nomeEmpresa').value,
      telefoneEmpresa: document.getElementById('telefoneEmpresa').value,
      respEmail: document.getElementById('respEmail').value,
      status: document.getElementById('statusParceiro').value
    };
    const id = document.getElementById('parceiroId').value;
    if(editando && id){
      await db.collection("parceiros").doc(id).update(data);
    } else {
      await db.collection("parceiros").add({...data, criadoEm:new Date()});
    }
    fecharModal();
  });

  function renderParceiros(){
    db.collection("parceiros").onSnapshot(snapshot=>{
      const tbody = document.getElementById('parceirosTable');
      tbody.innerHTML = "";
      let ativos=0, inativos=0;
      snapshot.forEach(doc=>{
        const p = doc.data();
        if(p.status==="Ativo") ativos++; else inativos++;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${p.nomeEmpresa||""}</td>
          <td>${p.tipo||""}</td>
          <td>${p.telefoneEmpresa||""}</td>
          <td>${p.respEmail||""}</td>
          <td><button class="status-btn ${p.status==="Ativo"?"ativo":"inativo"}" onclick="toggleStatus('${doc.id}', '${p.status}')">${p.status}</button></td>
          <td><button onclick='abrirModal(${JSON.stringify({...p,id:doc.id})})'>Editar</button></td>
        `;
        tbody.appendChild(tr);
      });
      document.getElementById('totalParceiros').textContent = snapshot.size;
      document.getElementById('ativosParceiros').textContent = ativos;
      document.getElementById('inativosParceiros').textContent = inativos;
    });
  }

  async function toggleStatus(id, status){
    const novo = status==="Ativo"?"Inativo":"Ativo";
    await db.collection("parceiros").doc(id).update({status:novo});
  }

  renderParceiros();

  // Controle das abas do modal
  const tabButtons = document.querySelectorAll('.tabBtn');
  const tabs = document.querySelectorAll('.tab');
  tabButtons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      tabButtons.forEach(b=>b.classList.remove('active'));
      tabs.forEach(t=>t.classList.remove('active'));
      btn.classList.add('active');
      document.getElementById(btn.dataset.tab).classList.add('active');
    });
  });
</script>
</body>
</html>
